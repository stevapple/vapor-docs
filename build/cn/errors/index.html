


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://swiftclub.github.io/vapor-docs/errors/">
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.0">
    
    

<title>Vapor:  入门 &rarr;  Errors</title>


    

      <link rel="stylesheet" href="../assets/stylesheets/main.89dc9fe3.min.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecd4686e.min.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    

    


    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
        
<link rel="preconnect dns-prefetch" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-76177358-4","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview")})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="black" data-md-color-accent="blue">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#errors" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://swiftclub.github.io/vapor-docs" title="vapor-docs" class="md-header-nav__button md-logo" aria-label="vapor-docs">
      
  <img src="../logo.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            vapor-docs
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Errors
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/swiftclub/vapor-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://swiftclub.github.io/vapor-docs" title="vapor-docs" class="md-nav__button md-logo" aria-label="vapor-docs">
      
  <img src="../logo.png" alt="logo">

    </a>
    vapor-docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/swiftclub/vapor-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="序" class="md-nav__link">
      序
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      安装
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="安装" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        安装
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../install/macos/" title="macOS" class="md-nav__link">
      macOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/ubuntu/" title="Ubuntu" class="md-nav__link">
      Ubuntu
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      起步
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="起步" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        起步
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../hello-world/" title="Hello, world" class="md-nav__link">
      Hello, world
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../folder-structure/" title="Folder Structure" class="md-nav__link">
      Folder Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spm/" title="SPM" class="md-nav__link">
      SPM
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      入门
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="入门" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        入门
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../routing/" title="Routing" class="md-nav__link">
      Routing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../content/" title="Content" class="md-nav__link">
      Content
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../client/" title="Client" class="md-nav__link">
      Client
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../validation/" title="Validation" class="md-nav__link">
      Validation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../async/" title="Async" class="md-nav__link">
      Async
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../logging/" title="Logging" class="md-nav__link">
      Logging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../environment/" title="Environment" class="md-nav__link">
      Environment
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Errors
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z" /></svg>
        </span>
      </label>
    
    <a href="./" title="Errors" class="md-nav__link md-nav__link--active">
      Errors
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abort" class="md-nav__link">
    Abort
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abort-error" class="md-nav__link">
    Abort Error
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debuggable-error" class="md-nav__link">
    Debuggable Error
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack-traces" class="md-nav__link">
    Stack Traces
  </a>
  
    <nav class="md-nav" aria-label="Stack Traces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#swift-backtrace" class="md-nav__link">
    Swift Backtrace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-traces" class="md-nav__link">
    Error Traces
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-middleware" class="md-nav__link">
    Error Middleware
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Fluent
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Fluent" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Fluent
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../fluent/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fluent/models/" title="Models" class="md-nav__link">
      Models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fluent/migrations/" title="Migrations" class="md-nav__link">
      Migrations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fluent/relations/" title="Relations" class="md-nav__link">
      Relations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fluent/query-builder/" title="Query Builder" class="md-nav__link">
      Query Builder
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      进阶
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="进阶" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        进阶
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../middleware/" title="Middleware" class="md-nav__link">
      Middleware
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../testing/" title="Testing" class="md-nav__link">
      Testing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../server/" title="Server" class="md-nav__link">
      Server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../commands/" title="Commands" class="md-nav__link">
      Commands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../queues/" title="Queues" class="md-nav__link">
      Queues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../websockets/" title="WebSockets" class="md-nav__link">
      WebSockets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sessions/" title="Sessions" class="md-nav__link">
      Sessions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../services/" title="Services" class="md-nav__link">
      Services
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      安全
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="安全" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        安全
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../authentication/" title="Authentication" class="md-nav__link">
      Authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../crypto/" title="Crypto" class="md-nav__link">
      Crypto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../passwords/" title="Passwords" class="md-nav__link">
      Passwords
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      部署
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="部署" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        部署
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../deploy/digital-ocean/" title="DigitalOcean" class="md-nav__link">
      DigitalOcean
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deploy/supervisor/" title="Supervisor" class="md-nav__link">
      Supervisor
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deploy/nginx/" title="Nginx" class="md-nav__link">
      Nginx
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Version (4.0)
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Version (4.0)" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Version (4.0)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../version/1_5/" title="1.5" class="md-nav__link">
      1.5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../version/2_0/" title="2.0" class="md-nav__link">
      2.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../version/3_0/" title="3.0" class="md-nav__link">
      3.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../version/4_0/" title="4.0" class="md-nav__link">
      4.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../upgrading/" title="Upgrading" class="md-nav__link">
      Upgrading
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abort" class="md-nav__link">
    Abort
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abort-error" class="md-nav__link">
    Abort Error
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debuggable-error" class="md-nav__link">
    Debuggable Error
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack-traces" class="md-nav__link">
    Stack Traces
  </a>
  
    <nav class="md-nav" aria-label="Stack Traces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#swift-backtrace" class="md-nav__link">
    Swift Backtrace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-traces" class="md-nav__link">
    Error Traces
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-middleware" class="md-nav__link">
    Error Middleware
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/swiftclub/vapor-docs/edit/master/docs/errors.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" /></svg>
                  </a>
                
                
                  
                
                
                <h1 id="errors">Errors<a class="headerlink" href="#errors" title="Permanent link">&para;</a></h1>
<p>Vapor builds on Swift's <code>Error</code> protocol for error handling. Route handlers can either <code>throw</code> an error or return a failed <code>EventLoopFuture</code>. Throwing or returning a Swift <code>Error</code> will result in a <code>500</code> status response and the error will be logged. <code>AbortError</code> and <code>DebuggableError</code> can be used to change the resulting response and logging respectively. The handling of errors is done by <code>ErrorMiddleware</code>. This middleware is added to the application by default and can be replaced with custom logic if desired. </p>
<h2 id="abort">Abort<a class="headerlink" href="#abort" title="Permanent link">&para;</a></h2>
<p>Vapor provides a default error struct named <code>Abort</code>. This struct conforms to both <code>AbortError</code> and <code>DebuggableError</code>. You can initialize it with an HTTP status and optional failure reason.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// 400 error, default &quot;Not Found&quot; reason used.</span>
<span class="k">throw</span> <span class="n">Abort</span><span class="p">(.</span><span class="n">notFound</span><span class="p">)</span>

<span class="c1">// 401 error, custom reason used.</span>
<span class="k">throw</span> <span class="n">Abort</span><span class="p">(.</span><span class="n">unauthorized</span><span class="p">,</span> <span class="n">reason</span><span class="p">:</span> <span class="s">&quot;Invalid Credentials&quot;</span><span class="p">)</span>
</code></pre></div>


<p>In asynchronous situations where throwing is not supported, like in a <code>flatMap</code> closure, you can return a failed future.</p>
<div class="codehilite"><pre><span></span><code><span class="k">guard</span> <span class="kd">let</span> <span class="nv">user</span> <span class="p">=</span> <span class="n">user</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">req</span><span class="p">.</span><span class="n">eventLoop</span><span class="p">.</span><span class="n">makeFailedFuture</span><span class="p">(</span><span class="n">Abort</span><span class="p">(.</span><span class="n">notFound</span><span class="p">))</span>    
<span class="p">}</span>
<span class="k">return</span> <span class="n">user</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
</code></pre></div>


<p>Vapor includes a helper extension for unwrapping futures with optional values: <code>unwrap(or:)</code>. </p>
<div class="codehilite"><pre><span></span><code><span class="n">User</span><span class="p">.</span><span class="bp">find</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="n">db</span><span class="p">)</span>
    <span class="p">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">or</span><span class="p">:</span> <span class="n">Abort</span><span class="p">(.</span><span class="n">notFound</span><span class="p">))</span>
    <span class="p">.</span><span class="n">flatMap</span> 
<span class="p">{</span> <span class="n">user</span> <span class="k">in</span>
    <span class="c1">// Non-optional User supplied to closure.</span>
<span class="p">}</span>
</code></pre></div>


<p>If <code>User.find</code> returns <code>nil</code>, the future will be failed with the supplied error. Otherwise, the <code>flatMap</code> will be supplied with a non-optional value.</p>
<h2 id="abort-error">Abort Error<a class="headerlink" href="#abort-error" title="Permanent link">&para;</a></h2>
<p>By default, any Swift <code>Error</code> thrown or returned by a route closure will result in a <code>500 Internal Server Error</code> response. When built in debug mode, <code>ErrorMiddleware</code> will include a description of the error. This is stripped out for security reasons when the project is built in release mode. </p>
<p>To configure the resulting HTTP response status or reason for a particular error, conform it to <code>AbortError</code>. </p>
<div class="codehilite"><pre><span></span><code><span class="kd">import</span> <span class="nc">Vapor</span>

<span class="kd">enum</span> <span class="nc">MyError</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">userNotLoggedIn</span>
    <span class="k">case</span> <span class="n">invalidEmail</span><span class="p">(</span><span class="nb">String</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="nc">MyError</span><span class="p">:</span> <span class="n">AbortError</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">reason</span><span class="p">:</span> <span class="nb">String</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="kc">self</span> <span class="p">{</span>
        <span class="k">case</span> <span class="p">.</span><span class="n">userNotLoggedIn</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;User is not logged in.&quot;</span>
        <span class="k">case</span> <span class="p">.</span><span class="n">invalidEmail</span><span class="p">(</span><span class="kd">let</span> <span class="nv">email</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&quot;Email address is not valid: </span><span class="si">\(</span><span class="n">email</span><span class="si">)</span><span class="s">.&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nv">status</span><span class="p">:</span> <span class="n">HTTPStatus</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="kc">self</span> <span class="p">{</span>
        <span class="k">case</span> <span class="p">.</span><span class="n">userNotLoggedIn</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">.</span><span class="n">unauthorized</span>
        <span class="k">case</span> <span class="p">.</span><span class="n">invalidEmail</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">.</span><span class="n">badRequest</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="debuggable-error">Debuggable Error<a class="headerlink" href="#debuggable-error" title="Permanent link">&para;</a></h2>
<p><code>ErrorMiddleware</code> uses the <code>Logger.report(error:)</code> method for logging errors thrown by your routes. This method will check for conformance to protocols like <code>CustomStringConvertible</code> and <code>LocalizedError</code> to log readable messages.</p>
<p>To customize error logging, you can conform your errors to <code>DebuggableError</code>. This protocol includes a number of helpful properties like a unique identifier, source location, and stack trace. Most of these properties are optional which makes adopting the conformance easy. </p>
<p>To best conform to <code>DebuggableError</code>, your error should be a struct so that it can store source and stack trace information if needed. Below is an example of the aforementioned <code>MyError</code> enum updated to use a <code>struct</code> and capture error source information.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">import</span> <span class="nc">Vapor</span>

<span class="kd">struct</span> <span class="nc">MyError</span><span class="p">:</span> <span class="n">DebuggableError</span> <span class="p">{</span>
    <span class="kd">enum</span> <span class="nc">Value</span> <span class="p">{</span>
        <span class="k">case</span> <span class="n">userNotLoggedIn</span>
        <span class="k">case</span> <span class="n">invalidEmail</span><span class="p">(</span><span class="nb">String</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nv">identifier</span><span class="p">:</span> <span class="nb">String</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="kc">self</span><span class="p">.</span><span class="n">value</span> <span class="p">{</span>
        <span class="k">case</span> <span class="p">.</span><span class="n">userNotLoggedIn</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;userNotLoggedIn&quot;</span>
        <span class="k">case</span> <span class="p">.</span><span class="n">invalidEmail</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;invalidEmail&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nv">reason</span><span class="p">:</span> <span class="nb">String</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="kc">self</span><span class="p">.</span><span class="n">value</span> <span class="p">{</span>
        <span class="k">case</span> <span class="p">.</span><span class="n">userNotLoggedIn</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;User is not logged in.&quot;</span>
        <span class="k">case</span> <span class="p">.</span><span class="n">invalidEmail</span><span class="p">(</span><span class="kd">let</span> <span class="nv">email</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&quot;Email address is not valid: </span><span class="si">\(</span><span class="n">email</span><span class="si">)</span><span class="s">.&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nv">value</span><span class="p">:</span> <span class="n">Value</span>
    <span class="kd">var</span> <span class="nv">source</span><span class="p">:</span> <span class="n">ErrorSource</span><span class="p">?</span>

    <span class="kd">init</span><span class="p">(</span>
        <span class="kc">_</span> <span class="n">value</span><span class="p">:</span> <span class="n">Value</span><span class="p">,</span>
        <span class="n">file</span><span class="p">:</span> <span class="nb">String</span> <span class="p">=</span> <span class="kc">#file</span><span class="p">,</span>
        <span class="n">function</span><span class="p">:</span> <span class="nb">String</span> <span class="p">=</span> <span class="kc">#function</span><span class="p">,</span>
        <span class="n">line</span><span class="p">:</span> <span class="nb">UInt</span> <span class="p">=</span> <span class="kc">#line</span><span class="p">,</span>
        <span class="n">column</span><span class="p">:</span> <span class="nb">UInt</span> <span class="p">=</span> <span class="kc">#column</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="n">value</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">source</span> <span class="p">=</span> <span class="p">.</span><span class="kd">init</span><span class="p">(</span>
            <span class="n">file</span><span class="p">:</span> <span class="n">file</span><span class="p">,</span>
            <span class="n">function</span><span class="p">:</span> <span class="n">function</span><span class="p">,</span>
            <span class="n">line</span><span class="p">:</span> <span class="n">line</span><span class="p">,</span>
            <span class="n">column</span><span class="p">:</span> <span class="n">column</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p><code>DebuggableError</code> has several other properties like <code>possibleCauses</code> and <code>suggestedFixes</code> that you can use to improve the debuggability of your errors. Take a look at the protocol itself for more information.</p>
<h2 id="stack-traces">Stack Traces<a class="headerlink" href="#stack-traces" title="Permanent link">&para;</a></h2>
<p>Vapor includes support for viewing stack traces for both normal Swift errors and crashes. </p>
<h3 id="swift-backtrace">Swift Backtrace<a class="headerlink" href="#swift-backtrace" title="Permanent link">&para;</a></h3>
<p>Vapor uses the <a href="https://github.com/swift-server/swift-backtrace">SwiftBacktrace</a> library to provide stack traces after a fatal error or assertion on Linux. In order for this to work, your app must include debug symbols during compilation.</p>
<div class="codehilite"><pre><span></span><code>swift build -c release -Xswiftc -g
</code></pre></div>


<h3 id="error-traces">Error Traces<a class="headerlink" href="#error-traces" title="Permanent link">&para;</a></h3>
<p>By default, <code>Abort</code> will capture the current stack trace when initialized. Your custom error types can achieve this by conforming to <code>DebuggableError</code> and storing <code>StackTrace.capture()</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">import</span> <span class="nc">Vapor</span>

<span class="kd">struct</span> <span class="nc">MyError</span><span class="p">:</span> <span class="n">DebuggableError</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">identifier</span><span class="p">:</span> <span class="nb">String</span>
    <span class="kd">var</span> <span class="nv">reason</span><span class="p">:</span> <span class="nb">String</span>
    <span class="kd">var</span> <span class="nv">stackTrace</span><span class="p">:</span> <span class="n">StackTrace</span><span class="p">?</span>

    <span class="kd">init</span><span class="p">(</span>
        <span class="n">identifier</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
        <span class="n">reason</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
        <span class="n">stackTrace</span><span class="p">:</span> <span class="n">StackTrace</span><span class="p">?</span> <span class="p">=</span> <span class="p">.</span><span class="n">capture</span><span class="p">()</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">identifier</span> <span class="p">=</span> <span class="n">identifier</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">reason</span> <span class="p">=</span> <span class="n">reason</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">stackTrace</span> <span class="p">=</span> <span class="n">stackTrace</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>When your application's <a href="../logging/#level">log level</a> is set to <code>.debug</code> or lower, error stack traces will be included in log output. </p>
<p>Stack traces will not be captured when the log level is greater than <code>.debug</code>. To override this behavior, set <code>StackTrace.isCaptureEnabled</code> manually in <code>configure</code>. </p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Always capture stack traces, regardless of log level.</span>
<span class="n">StackTrace</span><span class="p">.</span><span class="n">isCaptureEnabled</span> <span class="p">=</span> <span class="kc">true</span>
</code></pre></div>


<h2 id="error-middleware">Error Middleware<a class="headerlink" href="#error-middleware" title="Permanent link">&para;</a></h2>
<p><code>ErrorMiddleware</code> is the only middleware added to your application by default. This middleware converts Swift errors that have been thrown or returned by your route handlers into HTTP responses. Without this middleware, errors thrown will result in the connection being closed without a response. </p>
<p>To customize error handling beyond what <code>AbortError</code> and <code>DebuggableError</code> provide, you can replace <code>ErrorMiddleware</code> with your own error handling logic. To do this, first remove the default error middleware by setting <code>app.middleware</code> to an empty configuration. Then, add your own error handling middleware as the first middleware to your application.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Remove all existing middleware.</span>
<span class="n">app</span><span class="p">.</span><span class="n">middleware</span> <span class="p">=</span> <span class="p">.</span><span class="kd">init</span><span class="p">()</span>
<span class="c1">// Add custom error handling middleware first.</span>
<span class="n">app</span><span class="p">.</span><span class="n">middleware</span><span class="p">.</span><span class="n">use</span><span class="p">(</span><span class="n">MyErrorMiddleware</span><span class="p">())</span>
</code></pre></div>


<p>Very few middleware should go <em>before</em> the error handling middleware. A notable exception to this rule is <code>CORSMiddleware</code>.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../environment/" title="Environment" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Environment
              </div>
            </div>
          </a>
        
        
          <a href="../fluent/overview/" title="Overview" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Overview
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" /></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.36cbf620.min.js"></script>
      <script src="../assets/javascripts/bundle.00c583dd.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.7f7c8775.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>