


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://docs.vapor.codes/4.0/authentication/">
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.0">
    
    
  
    <title>Vapor:  Security &rarr;  Authentication</title>
  

    
  
      <link rel="stylesheet" href="../assets/stylesheets/main.89dc9fe3.min.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecd4686e.min.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
  <link rel="stylesheet" type="text/css" href="../styles/carbon.css">

    
  
  <script src="../scripts/carbon.js"></script>

    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
        
<link rel="preconnect dns-prefetch" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-76177358-4","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview")})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="black" data-md-color-accent="blue">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#authentication" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://docs.vapor.codes/4.0/" title="Vapor Docs" class="md-header-nav__button md-logo" aria-label="Vapor Docs">
      
  <img src="../logo.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Vapor Docs
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Authentication
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="http://github.com/vapor/vapor/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://docs.vapor.codes/4.0/" title="Vapor Docs" class="md-nav__button md-logo" aria-label="Vapor Docs">
      
  <img src="../logo.png" alt="logo">

    </a>
    Vapor Docs
  </label>
  
    <div class="md-nav__source">
      
<a href="http://github.com/vapor/vapor/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Welcome" class="md-nav__link">
      Welcome
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Install
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Install" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Install
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../install/macos/" title="macOS" class="md-nav__link">
      macOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/ubuntu/" title="Ubuntu" class="md-nav__link">
      Ubuntu
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Getting Started
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../hello-world/" title="Hello, world" class="md-nav__link">
      Hello, world
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../folder-structure/" title="Folder Structure" class="md-nav__link">
      Folder Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spm/" title="SPM" class="md-nav__link">
      SPM
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Basics
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Basics" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Basics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../routing/" title="Routing" class="md-nav__link">
      Routing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../content/" title="Content" class="md-nav__link">
      Content
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../client/" title="Client" class="md-nav__link">
      Client
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../validation/" title="Validation" class="md-nav__link">
      Validation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../async/" title="Async" class="md-nav__link">
      Async
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../logging/" title="Logging" class="md-nav__link">
      Logging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../environment/" title="Environment" class="md-nav__link">
      Environment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../errors/" title="Errors" class="md-nav__link">
      Errors
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Fluent
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Fluent" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Fluent
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../fluent/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fluent/models/" title="Models" class="md-nav__link">
      Models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fluent/migrations/" title="Migrations" class="md-nav__link">
      Migrations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fluent/relations/" title="Relations" class="md-nav__link">
      Relations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fluent/query-builder/" title="Query Builder" class="md-nav__link">
      Query Builder
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Advanced
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Advanced" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Advanced
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../middleware/" title="Middleware" class="md-nav__link">
      Middleware
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../testing/" title="Testing" class="md-nav__link">
      Testing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../server/" title="Server" class="md-nav__link">
      Server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../commands/" title="Commands" class="md-nav__link">
      Commands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../queues/" title="Queues" class="md-nav__link">
      Queues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../websockets/" title="WebSockets" class="md-nav__link">
      WebSockets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sessions/" title="Sessions" class="md-nav__link">
      Sessions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../services/" title="Services" class="md-nav__link">
      Services
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
    
    <label class="md-nav__link" for="nav-7">
      Security
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Security" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Security
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Authentication
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z" /></svg>
        </span>
      </label>
    
    <a href="./" title="Authentication" class="md-nav__link md-nav__link--active">
      Authentication
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authenticatable" class="md-nav__link">
    Authenticatable
  </a>
  
    <nav class="md-nav" aria-label="Authenticatable">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#route" class="md-nav__link">
    Route
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guard-middleware" class="md-nav__link">
    Guard Middleware
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic" class="md-nav__link">
    Basic
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bearer" class="md-nav__link">
    Bearer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#composition" class="md-nav__link">
    Composition
  </a>
  
    <nav class="md-nav" aria-label="Composition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#composing-methods" class="md-nav__link">
    Composing Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composing-users" class="md-nav__link">
    Composing Users
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manual" class="md-nav__link">
    Manual
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fluent" class="md-nav__link">
    Fluent
  </a>
  
    <nav class="md-nav" aria-label="Fluent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user" class="md-nav__link">
    User
  </a>
  
    <nav class="md-nav" aria-label="User">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-authenticatable" class="md-nav__link">
    Model Authenticatable
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-token" class="md-nav__link">
    User Token
  </a>
  
    <nav class="md-nav" aria-label="User Token">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-token-authenticatable" class="md-nav__link">
    Model Token Authenticatable
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session" class="md-nav__link">
    Session
  </a>
  
    <nav class="md-nav" aria-label="Session">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#session-authenticatable" class="md-nav__link">
    Session Authenticatable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-authenticator" class="md-nav__link">
    Session Authenticator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-session-authenticatable" class="md-nav__link">
    Model Session Authenticatable
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../crypto/" title="Crypto" class="md-nav__link">
      Crypto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../passwords/" title="Passwords" class="md-nav__link">
      Passwords
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Deploy
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Deploy" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Deploy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../deploy/digital-ocean/" title="DigitalOcean" class="md-nav__link">
      DigitalOcean
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deploy/supervisor/" title="Supervisor" class="md-nav__link">
      Supervisor
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deploy/nginx/" title="Nginx" class="md-nav__link">
      Nginx
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Version (4.0)
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Version (4.0)" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Version (4.0)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../version/1_5/" title="1.5" class="md-nav__link">
      1.5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../version/2_0/" title="2.0" class="md-nav__link">
      2.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../version/3_0/" title="3.0" class="md-nav__link">
      3.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../version/4_0/" title="4.0" class="md-nav__link">
      4.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../upgrading/" title="Upgrading" class="md-nav__link">
      Upgrading
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Translation
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Translation" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Translation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../i18n/cn/" title="Chinese (Simplified)" class="md-nav__link">
      Chinese (Simplified)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authenticatable" class="md-nav__link">
    Authenticatable
  </a>
  
    <nav class="md-nav" aria-label="Authenticatable">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#route" class="md-nav__link">
    Route
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guard-middleware" class="md-nav__link">
    Guard Middleware
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic" class="md-nav__link">
    Basic
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bearer" class="md-nav__link">
    Bearer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#composition" class="md-nav__link">
    Composition
  </a>
  
    <nav class="md-nav" aria-label="Composition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#composing-methods" class="md-nav__link">
    Composing Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composing-users" class="md-nav__link">
    Composing Users
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manual" class="md-nav__link">
    Manual
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fluent" class="md-nav__link">
    Fluent
  </a>
  
    <nav class="md-nav" aria-label="Fluent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user" class="md-nav__link">
    User
  </a>
  
    <nav class="md-nav" aria-label="User">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-authenticatable" class="md-nav__link">
    Model Authenticatable
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-token" class="md-nav__link">
    User Token
  </a>
  
    <nav class="md-nav" aria-label="User Token">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-token-authenticatable" class="md-nav__link">
    Model Token Authenticatable
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session" class="md-nav__link">
    Session
  </a>
  
    <nav class="md-nav" aria-label="Session">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#session-authenticatable" class="md-nav__link">
    Session Authenticatable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-authenticator" class="md-nav__link">
    Session Authenticator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-session-authenticatable" class="md-nav__link">
    Model Session Authenticatable
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/vapor/documentation/edit/master/4.0/docs/authentication.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" /></svg>
                  </a>
                
                
                  
                
                
                <h1 id="authentication">Authentication<a class="headerlink" href="#authentication" title="Permanent link">&para;</a></h1>
<p>Authentication is the act of verifying a user's identity. This is done through the verification of credentials like a username and password or unique token. Authentication (sometimes called auth/c) is distinct from authorization (auth/z) which is the act of verifying a previously authenticated user's permissions to perform certain tasks.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Vapor's Authentication API provides support for authenticating a user via the <code>Authorization</code> header, using <a href="https://tools.ietf.org/html/rfc7617">Basic</a> and <a href="https://tools.ietf.org/html/rfc6750">Bearer</a>. It also supports authenticating a user via the data decoded from the <a href="/content.md">Content</a> API.</p>
<p>Authentication is implemented by creating an <code>Authenticator</code> which contains the verification logic. An authenticator can be used to protect individual route groups or an entire app. The following authenticator helpers ship with Vapor:</p>
<table>
<thead>
<tr>
<th>Protocol</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>RequestAuthenticator</code></td>
<td>Base authenticator capable of creating middleware.</td>
</tr>
<tr>
<td><a href="#basic"><code>BasicAuthenticator</code></a></td>
<td>Authenticates Basic authorization header.</td>
</tr>
<tr>
<td><a href="#bearer"><code>BearerAuthenticator</code></a></td>
<td>Authenticates Bearer authorization header.</td>
</tr>
<tr>
<td><code>UserTokenAuthenticator</code></td>
<td>Authenticates a token type with associated user.</td>
</tr>
<tr>
<td><code>CredentialsAuthenticator</code></td>
<td>Authenticates a credentials payload from the request body.</td>
</tr>
</tbody>
</table>
<p>If authentication is successful, the authenticator adds the verified user to <code>req.auth</code>. This user can then be accessed using <code>req.auth.get(_:)</code> in routes protected by the authenticator. If authentication fails, the user is not added to <code>req.auth</code> and any attempts to access it will fail.</p>
<h2 id="authenticatable">Authenticatable<a class="headerlink" href="#authenticatable" title="Permanent link">&para;</a></h2>
<p>To use the Authentication API, you first need a user type that conforms to <code>Authenticatable</code>. This can be a <code>struct</code>, <code>class</code>, or even a Fluent <code>Model</code>. The following examples assume this simple <code>User</code> struct that has one property: <code>name</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">import</span> <span class="nc">Vapor</span>

<span class="kd">struct</span> <span class="nc">User</span><span class="p">:</span> <span class="n">Authenticatable</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">name</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>
</code></pre></div>


<p>Each example below will create an authenticator named <code>UserAuthenticator</code>. </p>
<h3 id="route">Route<a class="headerlink" href="#route" title="Permanent link">&para;</a></h3>
<p>Authenticators are middleware and be be used for protecting routes.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">let</span> <span class="nv">protected</span> <span class="p">=</span> <span class="n">app</span><span class="p">.</span><span class="n">grouped</span><span class="p">(</span><span class="n">UserAuthenticator</span><span class="p">())</span>
<span class="n">protected</span><span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s">&quot;me&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">req</span> <span class="p">-&gt;</span> <span class="nb">String</span> <span class="k">in</span>
    <span class="k">try</span> <span class="n">req</span><span class="p">.</span><span class="n">auth</span><span class="p">.</span><span class="n">require</span><span class="p">(</span><span class="n">User</span><span class="p">.</span><span class="kc">self</span><span class="p">).</span><span class="n">name</span>
<span class="p">}</span>
</code></pre></div>


<p><code>req.auth.require</code> is used to fetch the authenticated <code>User</code>. If authentication failed, this method will throw an error, protecting the route. </p>
<h3 id="guard-middleware">Guard Middleware<a class="headerlink" href="#guard-middleware" title="Permanent link">&para;</a></h3>
<p>You can also use <code>GuardMiddleware</code> in your route group to ensure that a user has been authenticated before reaching your route handler.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">let</span> <span class="nv">protected</span> <span class="p">=</span> <span class="n">app</span><span class="p">.</span><span class="n">grouped</span><span class="p">(</span><span class="n">UserAuthenticator</span><span class="p">())</span>
    <span class="p">.</span><span class="n">grouped</span><span class="p">(</span><span class="n">User</span><span class="p">.</span><span class="n">guardMiddleware</span><span class="p">())</span>
</code></pre></div>


<p>Requiring authentication is not done by the authenticator middleware to allow for composition of authenticators. Read more about <a href="#composition">composition</a> below.</p>
<h2 id="basic">Basic<a class="headerlink" href="#basic" title="Permanent link">&para;</a></h2>
<p>Basic authentication sends a username and password in the <code>Authorization</code> header. The username and password are concatenated with a colon (e.g. <code>test:secret</code>), base-64 encoded, and prefixed with <code>"Basic "</code>. The following example request encodes the username <code>test</code> with password <code>secret</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="nf">GET</span> <span class="nn">/me</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="o">:</span> <span class="l">Basic dGVzdDpzZWNyZXQ=</span>
</code></pre></div>


<p>Basic authentication is typically used once to log a user in and generate a token. This minimizes how frequently the user's sensitive password must be sent. You should never send Basic authorization over a plaintext or unverified TLS connection.</p>
<p>To implement Basic authentication in your app, create a new authenticator conforming to <code>BasicAuthenticator</code>. Below is an example authenticator hard-coded to verify the request from above.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">import</span> <span class="nc">Vapor</span>

<span class="kd">struct</span> <span class="nc">UserAuthenticator</span><span class="p">:</span> <span class="n">BasicAuthenticator</span> <span class="p">{</span>
    <span class="kd">typealias</span> <span class="n">User</span> <span class="p">=</span> <span class="n">App</span><span class="p">.</span><span class="n">User</span>

    <span class="kd">func</span> <span class="nf">authenticate</span><span class="p">(</span>
        <span class="n">basic</span><span class="p">:</span> <span class="n">BasicAuthorization</span><span class="p">,</span>
        <span class="k">for</span> <span class="n">request</span><span class="p">:</span> <span class="n">Request</span>
    <span class="p">)</span> <span class="p">-&gt;</span> <span class="n">EventLoopFuture</span><span class="p">&lt;</span><span class="n">User</span><span class="p">?</span><span class="o">&gt;</span> <span class="p">{</span>
       <span class="k">guard</span> <span class="n">basic</span><span class="p">.</span><span class="n">username</span> <span class="p">==</span> <span class="s">&quot;test&quot;</span> <span class="o">&amp;&amp;</span> <span class="n">basic</span><span class="p">.</span><span class="n">password</span> <span class="p">==</span> <span class="s">&quot;secret&quot;</span> <span class="k">else</span> <span class="p">{</span>
           <span class="k">return</span> <span class="n">request</span><span class="p">.</span><span class="n">eventLoop</span><span class="p">.</span><span class="n">makeSucceededFuture</span><span class="p">(</span><span class="kc">nil</span><span class="p">)</span>
       <span class="p">}</span>
       <span class="kd">let</span> <span class="nv">test</span> <span class="p">=</span> <span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="s">&quot;Vapor&quot;</span><span class="p">)</span>
       <span class="k">return</span> <span class="n">request</span><span class="p">.</span><span class="n">eventLoop</span><span class="p">.</span><span class="n">makeSucceededFuture</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>This protocol requires you to implement <code>authenticate(basic:for:)</code> which will be called when an incoming request contains the <code>Authorization: Basic ...</code> header. A <code>BasicAuthorization</code> struct containing the username and password is passed to the method.</p>
<p>In this test authenticator, the username and password are tested against hard-coded values. In a real authenticator, you might check against a database or external API. This is why the <code>authenticate</code> method allows you to return a future. </p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Passwords should never be stored in a database as plaintext. Always use password hashes for comparison.</p>
</div>
<p>If the authentication parameters are correct, in this case matching the hard-coded values, a <code>User</code> named Vapor is returned. If the authentication parameters do not match, <code>nil</code> is returned, which signifies authentication failed. </p>
<p>If you add this authenticator to your app, and test the route defined above, you should see the name <code>"Vapor"</code> returned for a successful login. If the credentials are not correct, you should see a <code>401 Unauthorized</code> error.</p>
<h2 id="bearer">Bearer<a class="headerlink" href="#bearer" title="Permanent link">&para;</a></h2>
<p>Bearer authentication sends a token in the <code>Authorization</code> header. The token is prefixed with <code>"Bearer "</code>. The following example request sends the token <code>foo</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="nf">GET</span> <span class="nn">/me</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="o">:</span> <span class="l">Bearer foo</span>
</code></pre></div>


<p>Bearer authentication is commonly used for authentication of API endpoints. The user typically requests a Bearer token by sending credentials like a username and password to a login endpoint. This token may last minutes or days depending on the application's needs. </p>
<p>As long as the token is valid, the user can use it in place of his or her credentials to authenticate against the API. If the token becomes invalid, a new one can be generated using the login endpoint.</p>
<p>To implement Bearer authentication in your app, create a new authenticator conforming to <code>BearerAuthenticator</code>. Below is an example authenticator hard-coded to verify the request from above.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">import</span> <span class="nc">Vapor</span>

<span class="kd">struct</span> <span class="nc">UserAuthenticator</span><span class="p">:</span> <span class="n">BearerAuthenticator</span> <span class="p">{</span>
    <span class="kd">typealias</span> <span class="n">User</span> <span class="p">=</span> <span class="n">App</span><span class="p">.</span><span class="n">User</span>

    <span class="kd">func</span> <span class="nf">authenticate</span><span class="p">(</span>
        <span class="n">bearer</span><span class="p">:</span> <span class="n">BearerAuthorization</span><span class="p">,</span>
        <span class="k">for</span> <span class="n">request</span><span class="p">:</span> <span class="n">Request</span>
    <span class="p">)</span> <span class="p">-&gt;</span> <span class="n">EventLoopFuture</span><span class="p">&lt;</span><span class="n">User</span><span class="p">?</span><span class="o">&gt;</span> <span class="p">{</span>
       <span class="k">guard</span> <span class="n">bearer</span><span class="p">.</span><span class="n">token</span> <span class="p">==</span> <span class="s">&quot;foo&quot;</span> <span class="k">else</span> <span class="p">{</span>
           <span class="k">return</span> <span class="n">request</span><span class="p">.</span><span class="n">eventLoop</span><span class="p">.</span><span class="n">makeSucceededFuture</span><span class="p">(</span><span class="kc">nil</span><span class="p">)</span>
       <span class="p">}</span>
       <span class="kd">let</span> <span class="nv">test</span> <span class="p">=</span> <span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="s">&quot;Vapor&quot;</span><span class="p">)</span>
       <span class="k">return</span> <span class="n">request</span><span class="p">.</span><span class="n">eventLoop</span><span class="p">.</span><span class="n">makeSucceededFuture</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>This protocol requires you to implement <code>authenticate(bearer:for:)</code> which will be called when an incoming request contains the <code>Authorization: Bearer ...</code> header. A <code>BearerAuthorization</code> struct containing the token is passed to the method.</p>
<p>In this test authenticator, the token is tested against a hard-coded value. In a real authenticator, you might verify the token by checking against a database or using cryptographic measures, like is done with JWT. This is why the <code>authenticate</code> method allows you to return a future. </p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When implementing token verification, it's important to consider horizontal scalability. If your application needs to handle many users concurrently, authentication can be a potential bottlneck. Consider how your design will scale across multiple instances of your application running at once.</p>
</div>
<p>If the authentication parameters are correct, in this case matching the hard-coded value, a <code>User</code> named Vapor is returned. If the authentication parameters do not match, <code>nil</code> is returned, which signifies authentication failed. </p>
<p>If you add this authenticator to your app, and test the route defined above, you should see the name <code>"Vapor"</code> returned for a successful login. If the credentials are not correct, you should see a <code>401 Unauthorized</code> error.</p>
<h2 id="composition">Composition<a class="headerlink" href="#composition" title="Permanent link">&para;</a></h2>
<p>Multiple authenticators can be composed (combined together) to create more complex endpoint authentication. Since an authenticator middleware will not reject the request if authentication fails, more than one of these middleware can be chained together. Authenticators can composed in two key ways. </p>
<h3 id="composing-methods">Composing Methods<a class="headerlink" href="#composing-methods" title="Permanent link">&para;</a></h3>
<p>The first method of authentication composition is chaining more than one authenticator for the same user type. Take the following example:</p>
<div class="codehilite"><pre><span></span><code><span class="n">app</span><span class="p">.</span><span class="n">grouped</span><span class="p">(</span><span class="n">UserPasswordAuthenticator</span><span class="p">())</span>
    <span class="p">.</span><span class="n">grouped</span><span class="p">(</span><span class="n">UserTokenAuthenticator</span><span class="p">())</span>
    <span class="p">.</span><span class="n">grouped</span><span class="p">(</span><span class="n">User</span><span class="p">.</span><span class="n">guardMiddleware</span><span class="p">())</span>
    <span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">&quot;login&quot;</span><span class="p">)</span> 
<span class="p">{</span> <span class="n">req</span> <span class="k">in</span>
    <span class="kd">let</span> <span class="nv">user</span> <span class="p">=</span> <span class="k">try</span> <span class="n">req</span><span class="p">.</span><span class="n">auth</span><span class="p">.</span><span class="n">require</span><span class="p">(</span><span class="n">User</span><span class="p">.</span><span class="kc">self</span><span class="p">)</span>
    <span class="c1">// Do something with user.</span>
<span class="p">}</span>
</code></pre></div>


<p>This example assumes two authenticators <code>UserPasswordAuthenticator</code> and <code>UserTokenAuthenticator</code> that both authenticate <code>User</code>. Both of these authenticators are added to the route group. Finally, <code>GuardMiddleware</code> is added after the authenticators to require that <code>User</code> was successfully authenticated. </p>
<p>This composition of authenticators results in a route that can be accessed by either password or token. Such a route could allow a user to login and generate a token, then continue to use that token to generate new tokens.</p>
<h3 id="composing-users">Composing Users<a class="headerlink" href="#composing-users" title="Permanent link">&para;</a></h3>
<p>The second method of authentication composition is chaining authenticators for different user types. Take the following example:</p>
<div class="codehilite"><pre><span></span><code><span class="n">app</span><span class="p">.</span><span class="n">grouped</span><span class="p">(</span><span class="n">AdminAuthenticator</span><span class="p">())</span>
    <span class="p">.</span><span class="n">grouped</span><span class="p">(</span><span class="n">UserAuthenticator</span><span class="p">())</span>
    <span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s">&quot;secure&quot;</span><span class="p">)</span> 
<span class="p">{</span> <span class="n">req</span> <span class="k">in</span>
    <span class="k">guard</span> <span class="n">req</span><span class="p">.</span><span class="n">auth</span><span class="p">.</span><span class="n">has</span><span class="p">(</span><span class="n">Admin</span><span class="p">.</span><span class="kc">self</span><span class="p">)</span> <span class="o">||</span> <span class="n">req</span><span class="p">.</span><span class="n">auth</span><span class="p">.</span><span class="n">has</span><span class="p">(</span><span class="n">User</span><span class="p">.</span><span class="kc">self</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="n">Abort</span><span class="p">(.</span><span class="n">unauthorized</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="c1">// Do something.</span>
<span class="p">}</span>
</code></pre></div>


<p>This example assumes two authenticators <code>AdminAuthenticator</code> and <code>UserAuthenticator</code> that authenticate <code>Admin</code> and <code>User</code>, respectively. Both of these authenticators are added to the route group. Instead of using <code>GuardMiddleware</code>, a check in the route handler is added to see if either <code>Admin</code> or <code>User</code> were authenticated. If not, an error is thrown.</p>
<p>This composition of authenticators results in a route that can be accessed by two different types of users with potentially different methods of authentication. Such a route could allow for normal user authentication while still giving access to a super-user.</p>
<h2 id="manual">Manual<a class="headerlink" href="#manual" title="Permanent link">&para;</a></h2>
<p>You can also handle authentication manually using <code>req.auth</code>. This is especially useful for testing.</p>
<p>To manually log a user in, use <code>req.auth.login(_:)</code>. Any <code>Authenticatable</code> user can be passed to this method.</p>
<div class="codehilite"><pre><span></span><code><span class="n">req</span><span class="p">.</span><span class="n">auth</span><span class="p">.</span><span class="n">login</span><span class="p">(</span><span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="s">&quot;Vapor&quot;</span><span class="p">))</span>
</code></pre></div>


<p>To get the authenticated user, use <code>req.auth.require(_:)</code></p>
<div class="codehilite"><pre><span></span><code><span class="kd">let</span> <span class="nv">user</span><span class="p">:</span> <span class="n">User</span> <span class="p">=</span> <span class="k">try</span> <span class="n">req</span><span class="p">.</span><span class="n">auth</span><span class="p">.</span><span class="n">require</span><span class="p">(</span><span class="n">User</span><span class="p">.</span><span class="kc">self</span><span class="p">)</span>
<span class="bp">print</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">name</span><span class="p">)</span> <span class="c1">// String</span>
</code></pre></div>


<p>You can also use <code>req.auth.get(_:)</code> if you don't want to automatically throw an error when authentication fails.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">let</span> <span class="nv">user</span> <span class="p">=</span> <span class="n">req</span><span class="p">.</span><span class="n">auth</span><span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="n">User</span><span class="p">.</span><span class="kc">self</span><span class="p">)</span>
<span class="bp">print</span><span class="p">(</span><span class="n">user</span><span class="p">?.</span><span class="n">name</span><span class="p">)</span> <span class="c1">// String?</span>
</code></pre></div>


<p>To unauthenticate a user, pass the user type to <code>req.auth.logout(_:)</code>. </p>
<div class="codehilite"><pre><span></span><code><span class="n">req</span><span class="p">.</span><span class="n">auth</span><span class="p">.</span><span class="n">logout</span><span class="p">(</span><span class="n">User</span><span class="p">.</span><span class="kc">self</span><span class="p">)</span>
</code></pre></div>


<h2 id="fluent">Fluent<a class="headerlink" href="#fluent" title="Permanent link">&para;</a></h2>
<p>Fluent defines two protocols <code>ModelAuthenticatable</code> and <code>ModelTokenAuthenticatable</code> which can be added to your existing models. Conforming your models to these protocols allows for the creation of authenticators for protecting endpoints. </p>
<p><code>ModelTokenAuthenticatable</code> authenticates with a Bearer token. This is what you use to protect most of your endpoints. <code>ModelAuthenticatable</code> authenticates with username and password and is used by a single endpoint for generating tokens. </p>
<p>This guide assumes you are familiar with Fluent and have successfully configured your app to use a database. If you are new to Fluent, start with the <a href="../fluent/overview/">overview</a>.</p>
<h3 id="user">User<a class="headerlink" href="#user" title="Permanent link">&para;</a></h3>
<p>To start, you will need a model representing the user that will be authenticated. For this guide, we'll be using the following model, but you are free to use an existing model.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">import</span> <span class="nc">Fluent</span>
<span class="kd">import</span> <span class="nc">Vapor</span>

<span class="kr">final</span> <span class="kd">class</span> <span class="nc">User</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span> <span class="n">Content</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="kd">let</span> <span class="nv">schema</span> <span class="p">=</span> <span class="s">&quot;users&quot;</span>

    <span class="p">@</span><span class="n">ID</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="p">.</span><span class="n">id</span><span class="p">)</span>
    <span class="kd">var</span> <span class="nv">id</span><span class="p">:</span> <span class="n">UUID</span><span class="p">?</span>

    <span class="p">@</span><span class="n">Field</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="s">&quot;name&quot;</span><span class="p">)</span>
    <span class="kd">var</span> <span class="nv">name</span><span class="p">:</span> <span class="nb">String</span>

    <span class="p">@</span><span class="n">Field</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="s">&quot;email&quot;</span><span class="p">)</span>
    <span class="kd">var</span> <span class="nv">email</span><span class="p">:</span> <span class="nb">String</span>

    <span class="p">@</span><span class="n">Field</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="s">&quot;password_hash&quot;</span><span class="p">)</span>
    <span class="kd">var</span> <span class="nv">passwordHash</span><span class="p">:</span> <span class="nb">String</span>

    <span class="kd">init</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>

    <span class="kd">init</span><span class="p">(</span><span class="n">id</span><span class="p">:</span> <span class="n">UUID</span><span class="p">?</span> <span class="p">=</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="n">email</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="n">passwordHash</span><span class="p">:</span> <span class="nb">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">id</span> <span class="p">=</span> <span class="n">id</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">name</span> <span class="p">=</span> <span class="n">name</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">email</span> <span class="p">=</span> <span class="n">email</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">passwordHash</span> <span class="p">=</span> <span class="n">passwordHash</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>The model must be able to store a username, in this case an email, and a password hash. The corresponding migration for this example model is here:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">import</span> <span class="nc">Fluent</span>
<span class="kd">import</span> <span class="nc">Vapor</span>

<span class="kd">extension</span> <span class="nc">User</span> <span class="p">{</span>
    <span class="kd">struct</span> <span class="nc">Migration</span><span class="p">:</span> <span class="n">Fluent</span><span class="p">.</span><span class="n">Migration</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nv">name</span><span class="p">:</span> <span class="nb">String</span> <span class="p">{</span> <span class="s">&quot;CreateUser&quot;</span> <span class="p">}</span>

        <span class="kd">func</span> <span class="nf">prepare</span><span class="p">(</span><span class="n">on</span> <span class="n">database</span><span class="p">:</span> <span class="n">Database</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">EventLoopFuture</span><span class="p">&lt;</span><span class="nb">Void</span><span class="p">&gt;</span> <span class="p">{</span>
            <span class="n">database</span><span class="p">.</span><span class="n">schema</span><span class="p">(</span><span class="s">&quot;users&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="n">id</span><span class="p">()</span>
                <span class="p">.</span><span class="n">field</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">string</span><span class="p">,</span> <span class="p">.</span><span class="kr">required</span><span class="p">)</span>
                <span class="p">.</span><span class="n">field</span><span class="p">(</span><span class="s">&quot;email&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">string</span><span class="p">,</span> <span class="p">.</span><span class="kr">required</span><span class="p">)</span>
                <span class="p">.</span><span class="n">field</span><span class="p">(</span><span class="s">&quot;password_hash&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">string</span><span class="p">,</span> <span class="p">.</span><span class="kr">required</span><span class="p">)</span>
                <span class="p">.</span><span class="n">create</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="kd">func</span> <span class="nf">revert</span><span class="p">(</span><span class="n">on</span> <span class="n">database</span><span class="p">:</span> <span class="n">Database</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">EventLoopFuture</span><span class="p">&lt;</span><span class="nb">Void</span><span class="p">&gt;</span> <span class="p">{</span>
            <span class="n">database</span><span class="p">.</span><span class="n">schema</span><span class="p">(</span><span class="s">&quot;users&quot;</span><span class="p">).</span><span class="n">delete</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>Don't forget to add the migration to <code>app.migrations</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="n">app</span><span class="p">.</span><span class="n">migrations</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">User</span><span class="p">.</span><span class="n">Migration</span><span class="p">())</span>
</code></pre></div>


<p>The first thing you will need is an endpoint to create new users. Let's use <code>POST /users</code>. Create a <a href="../content/">Content</a> struct representing the data this endpoint expects.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">import</span> <span class="nc">Vapor</span>

<span class="kd">extension</span> <span class="nc">User</span> <span class="p">{</span>
    <span class="kd">struct</span> <span class="nc">Create</span><span class="p">:</span> <span class="n">Content</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nv">name</span><span class="p">:</span> <span class="nb">String</span>
        <span class="kd">var</span> <span class="nv">email</span><span class="p">:</span> <span class="nb">String</span>
        <span class="kd">var</span> <span class="nv">password</span><span class="p">:</span> <span class="nb">String</span>
        <span class="kd">var</span> <span class="nv">confirmPassword</span><span class="p">:</span> <span class="nb">String</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>If you like, you can conform this struct to <a href="../validation/">Validatable</a> to add validation requirements.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">import</span> <span class="nc">Vapor</span>

<span class="kd">extension</span> <span class="nc">User</span><span class="p">.</span><span class="n">Create</span><span class="p">:</span> <span class="n">Validatable</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">validations</span><span class="p">(</span><span class="kc">_</span> <span class="n">validations</span><span class="p">:</span> <span class="kr">inout</span> <span class="n">Validations</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">validations</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="k">as</span><span class="p">:</span> <span class="nb">String</span><span class="p">.</span><span class="kc">self</span><span class="p">,</span> <span class="k">is</span><span class="p">:</span> <span class="o">!</span><span class="p">.</span><span class="n">empty</span><span class="p">)</span>
        <span class="n">validations</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;email&quot;</span><span class="p">,</span> <span class="k">as</span><span class="p">:</span> <span class="nb">String</span><span class="p">.</span><span class="kc">self</span><span class="p">,</span> <span class="k">is</span><span class="p">:</span> <span class="p">.</span><span class="n">email</span><span class="p">)</span>
        <span class="n">validations</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;password&quot;</span><span class="p">,</span> <span class="k">as</span><span class="p">:</span> <span class="nb">String</span><span class="p">.</span><span class="kc">self</span><span class="p">,</span> <span class="k">is</span><span class="p">:</span> <span class="p">.</span><span class="bp">count</span><span class="p">(</span><span class="mf">8.</span><span class="p">..))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>Now you can create the <code>POST /users</code> endpoint. </p>
<div class="codehilite"><pre><span></span><code><span class="n">app</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">&quot;users&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">req</span> <span class="p">-&gt;</span> <span class="n">EventLoopFuture</span><span class="p">&lt;</span><span class="n">User</span><span class="p">&gt;</span> <span class="k">in</span>
    <span class="k">try</span> <span class="n">User</span><span class="p">.</span><span class="n">Create</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
    <span class="kd">let</span> <span class="nv">create</span> <span class="p">=</span> <span class="k">try</span> <span class="n">req</span><span class="p">.</span><span class="n">content</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">User</span><span class="p">.</span><span class="n">Create</span><span class="p">.</span><span class="kc">self</span><span class="p">)</span>
    <span class="k">guard</span> <span class="n">create</span><span class="p">.</span><span class="n">password</span> <span class="p">==</span> <span class="n">create</span><span class="p">.</span><span class="n">confirmPassword</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="n">Abort</span><span class="p">(.</span><span class="n">badRequest</span><span class="p">,</span> <span class="n">reason</span><span class="p">:</span> <span class="s">&quot;Passwords did not match&quot;</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="nv">user</span> <span class="p">=</span> <span class="k">try</span> <span class="n">User</span><span class="p">(</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">create</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">email</span><span class="p">:</span> <span class="n">create</span><span class="p">.</span><span class="n">email</span><span class="p">,</span>
        <span class="n">passwordHash</span><span class="p">:</span> <span class="n">Bcrypt</span><span class="p">.</span><span class="n">hash</span><span class="p">(</span><span class="n">create</span><span class="p">.</span><span class="n">password</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">user</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">on</span><span class="p">:</span> <span class="n">req</span><span class="p">.</span><span class="n">db</span><span class="p">)</span>
        <span class="p">.</span><span class="bp">map</span> <span class="p">{</span> <span class="n">user</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>This endpoint validates the incoming request, decodes the <code>User.Create</code> struct, and checks that the passwords match. It then uses the decoded data to create a new <code>User</code> and saves it to the database. The plaintext password is hashed using <code>Bcrypt</code> before saving to the database. </p>
<p>Build and run the project, making sure to migrate the database first, then use the following request to create a new user. </p>
<div class="codehilite"><pre><span></span><code><span class="nf">POST</span> <span class="nn">/users</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">97</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>

<span class="p">{</span>
    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Vapor&quot;</span><span class="p">,</span>
    <span class="nt">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;test@vapor.codes&quot;</span><span class="p">,</span>
    <span class="nt">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;secret&quot;</span><span class="p">,</span>
    <span class="nt">&quot;confirmPassword&quot;</span><span class="p">:</span> <span class="s2">&quot;secret&quot;</span>
<span class="p">}</span>
</code></pre></div>


<h4 id="model-authenticatable">Model Authenticatable<a class="headerlink" href="#model-authenticatable" title="Permanent link">&para;</a></h4>
<p>Now that you have a user model and an endpoint to create new users, let's conform the model to <code>ModelAuthenticatable</code>. This will allow for the model to be authenticated using username and password.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">import</span> <span class="nc">Fluent</span>
<span class="kd">import</span> <span class="nc">Vapor</span>

<span class="kd">extension</span> <span class="nc">User</span><span class="p">:</span> <span class="n">ModelAuthenticatable</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="kd">let</span> <span class="nv">usernameKey</span> <span class="p">=</span> <span class="err">\</span><span class="n">User</span><span class="p">.</span><span class="err">$</span><span class="n">email</span>
    <span class="kd">static</span> <span class="kd">let</span> <span class="nv">passwordHashKey</span> <span class="p">=</span> <span class="err">\</span><span class="n">User</span><span class="p">.</span><span class="err">$</span><span class="n">passwordHash</span>

    <span class="kd">func</span> <span class="nf">verify</span><span class="p">(</span><span class="n">password</span><span class="p">:</span> <span class="nb">String</span><span class="p">)</span> <span class="kr">throws</span> <span class="p">-&gt;</span> <span class="nb">Bool</span> <span class="p">{</span>
        <span class="k">try</span> <span class="n">Bcrypt</span><span class="p">.</span><span class="n">verify</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">created</span><span class="p">:</span> <span class="kc">self</span><span class="p">.</span><span class="n">passwordHash</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>This extension adds <code>ModelAuthenticatable</code> conformance to <code>User</code>. The first two properties specify which fields should be used for storing the username and password hash respectively. The <code>\</code> notation creates a key path to the fields that Fluent can use to access them.</p>
<p>The last requirement is a method for verifying plaintext passwords sent in the Basic authentication header. Since we're using Bcrypt to hash the password during signup, we'll use Bcrypt to verify that the supplied password matches the stored password hash.</p>
<p>Now that the <code>User</code> conforms to <code>ModelAuthenticatable</code>, we can create an authenticator for protecting the login route.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">let</span> <span class="nv">passwordProtected</span> <span class="p">=</span> <span class="n">app</span><span class="p">.</span><span class="n">grouped</span><span class="p">(</span><span class="n">User</span><span class="p">.</span><span class="n">authenticator</span><span class="p">())</span>
<span class="n">passwordProtected</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">&quot;login&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">req</span> <span class="p">-&gt;</span> <span class="n">User</span> <span class="k">in</span>
    <span class="k">try</span> <span class="n">req</span><span class="p">.</span><span class="n">auth</span><span class="p">.</span><span class="n">require</span><span class="p">(</span><span class="n">User</span><span class="p">.</span><span class="kc">self</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>


<p><code>ModelAuthenticatable</code> adds a static method <code>authenticator</code> for creating an authenticator.</p>
<p>Test that this route works by sending the following request.</p>
<div class="codehilite"><pre><span></span><code><span class="nf">POST</span> <span class="nn">/login</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="o">:</span> <span class="l">Basic dGVzdEB2YXBvci5jb2RlczpzZWNyZXQ=</span>
</code></pre></div>


<p>This request passes the username <code>test@vapor.codes</code> and password <code>secret</code> via the Basic authentication header. You should see the previously created user returned.</p>
<p>While you could theoretically use Basic authentication to protect all of your endpoints, it's recommended to use a separate token instead. This minimizes how often you must send the user's sensitive password over the Internet. It also makes authentication much faster since you only need to perform password hashing during login.</p>
<h3 id="user-token">User Token<a class="headerlink" href="#user-token" title="Permanent link">&para;</a></h3>
<p>Create a new model for representing user tokens.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">import</span> <span class="nc">Fluent</span>
<span class="kd">import</span> <span class="nc">Vapor</span>

<span class="kr">final</span> <span class="kd">class</span> <span class="nc">UserToken</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span> <span class="n">Content</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="kd">let</span> <span class="nv">schema</span> <span class="p">=</span> <span class="s">&quot;user_tokens&quot;</span>

    <span class="p">@</span><span class="n">ID</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="p">.</span><span class="n">id</span><span class="p">)</span>
    <span class="kd">var</span> <span class="nv">id</span><span class="p">:</span> <span class="n">UUID</span><span class="p">?</span>

    <span class="p">@</span><span class="n">Field</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="s">&quot;value&quot;</span><span class="p">)</span>
    <span class="kd">var</span> <span class="nv">value</span><span class="p">:</span> <span class="nb">String</span>

    <span class="p">@</span><span class="n">Parent</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="s">&quot;user_id&quot;</span><span class="p">)</span>
    <span class="kd">var</span> <span class="nv">user</span><span class="p">:</span> <span class="n">User</span>

    <span class="kd">init</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>

    <span class="kd">init</span><span class="p">(</span><span class="n">id</span><span class="p">:</span> <span class="n">UUID</span><span class="p">?</span> <span class="p">=</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="n">userID</span><span class="p">:</span> <span class="n">User</span><span class="p">.</span><span class="n">IDValue</span><span class="p">)</span> <span class="p">{</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">id</span> <span class="p">=</span> <span class="n">id</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="n">value</span>
        <span class="kc">self</span><span class="p">.</span><span class="err">$</span><span class="n">user</span><span class="p">.</span><span class="n">id</span> <span class="p">=</span> <span class="n">userID</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>This model must have a <code>value</code> field for storing the token's unique string. It must also have a <a href="../fluent/overview/#parent">parent-relation</a> to the user model. You may add additional properties to this token as you see fit, such as an expiration date. </p>
<p>Next, create a migration for this model.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">import</span> <span class="nc">Fluent</span>

<span class="kd">extension</span> <span class="nc">UserToken</span> <span class="p">{</span>
    <span class="kd">struct</span> <span class="nc">Migration</span><span class="p">:</span> <span class="n">Fluent</span><span class="p">.</span><span class="n">Migration</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nv">name</span><span class="p">:</span> <span class="nb">String</span> <span class="p">{</span> <span class="s">&quot;CreateUserToken&quot;</span> <span class="p">}</span>

        <span class="kd">func</span> <span class="nf">prepare</span><span class="p">(</span><span class="n">on</span> <span class="n">database</span><span class="p">:</span> <span class="n">Database</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">EventLoopFuture</span><span class="p">&lt;</span><span class="nb">Void</span><span class="p">&gt;</span> <span class="p">{</span>
            <span class="n">database</span><span class="p">.</span><span class="n">schema</span><span class="p">(</span><span class="s">&quot;user_tokens&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="n">id</span><span class="p">()</span>
                <span class="p">.</span><span class="n">field</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">string</span><span class="p">,</span> <span class="p">.</span><span class="kr">required</span><span class="p">)</span>
                <span class="p">.</span><span class="n">field</span><span class="p">(</span><span class="s">&quot;user_id&quot;</span><span class="p">,</span> <span class="p">.</span><span class="n">uuid</span><span class="p">,</span> <span class="p">.</span><span class="kr">required</span><span class="p">,</span> <span class="p">.</span><span class="n">references</span><span class="p">(</span><span class="s">&quot;users&quot;</span><span class="p">,</span> <span class="s">&quot;id&quot;</span><span class="p">))</span>
                <span class="p">.</span><span class="n">unique</span><span class="p">(</span><span class="n">on</span><span class="p">:</span> <span class="s">&quot;value&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="n">create</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="kd">func</span> <span class="nf">revert</span><span class="p">(</span><span class="n">on</span> <span class="n">database</span><span class="p">:</span> <span class="n">Database</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">EventLoopFuture</span><span class="p">&lt;</span><span class="nb">Void</span><span class="p">&gt;</span> <span class="p">{</span>
            <span class="n">database</span><span class="p">.</span><span class="n">schema</span><span class="p">(</span><span class="s">&quot;user_tokens&quot;</span><span class="p">).</span><span class="n">delete</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>Notice that this migration makes the <code>value</code> field unique. It also creates a foreign key reference between the <code>user_id</code> field and the users table. </p>
<p>Don't forget to add the migration to <code>app.migrations</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="n">app</span><span class="p">.</span><span class="n">migrations</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">UserToken</span><span class="p">.</span><span class="n">Migration</span><span class="p">())</span>
</code></pre></div>


<p>Finally, add a method on <code>User</code> for generating a new token. This method will be used during login.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">extension</span> <span class="nc">User</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">generateToken</span><span class="p">()</span> <span class="kr">throws</span> <span class="p">-&gt;</span> <span class="n">UserToken</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">.</span><span class="kd">init</span><span class="p">(</span>
            <span class="n">value</span><span class="p">:</span> <span class="p">[</span><span class="nb">UInt8</span><span class="p">].</span><span class="n">random</span><span class="p">(</span><span class="bp">count</span><span class="p">:</span> <span class="mi">16</span><span class="p">).</span><span class="n">base64</span><span class="p">,</span> 
            <span class="n">userID</span><span class="p">:</span> <span class="kc">self</span><span class="p">.</span><span class="n">requireID</span><span class="p">()</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>Here we're using <code>[UInt8].random(count:)</code> to generate a random token value. For this example, 16 bytes, or 128 bits, of random data are being used. You can adjust this number as you see fit. The random data is then base-64 encoded to make it easy to transmit in HTTP headers.</p>
<p>Now that you can generate user tokens, update the <code>POST /login</code> route to create and return a token.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">let</span> <span class="nv">passwordProtected</span> <span class="p">=</span> <span class="n">app</span><span class="p">.</span><span class="n">grouped</span><span class="p">(</span><span class="n">User</span><span class="p">.</span><span class="n">authenticator</span><span class="p">())</span>
<span class="n">passwordProtected</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">&quot;login&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">req</span> <span class="p">-&gt;</span> <span class="n">EventLoopFuture</span><span class="p">&lt;</span><span class="n">UserToken</span><span class="p">&gt;</span> <span class="k">in</span>
    <span class="kd">let</span> <span class="nv">user</span> <span class="p">=</span> <span class="k">try</span> <span class="n">req</span><span class="p">.</span><span class="n">auth</span><span class="p">.</span><span class="n">require</span><span class="p">(</span><span class="n">User</span><span class="p">.</span><span class="kc">self</span><span class="p">)</span>
    <span class="kd">let</span> <span class="nv">token</span> <span class="p">=</span> <span class="k">try</span> <span class="n">user</span><span class="p">.</span><span class="n">generateToken</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">token</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">on</span><span class="p">:</span> <span class="n">req</span><span class="p">.</span><span class="n">db</span><span class="p">)</span>
        <span class="p">.</span><span class="bp">map</span> <span class="p">{</span> <span class="n">token</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>Test that this route works by using the same login request from above. You should now get a token upon logging in that looks something like:</p>
<div class="codehilite"><pre><span></span><code>8gtg300Jwdhc/Ffw784EXA==
</code></pre></div>


<p>Hold onto the token you get as we'll use it shortly.</p>
<h4 id="model-token-authenticatable">Model Token Authenticatable<a class="headerlink" href="#model-token-authenticatable" title="Permanent link">&para;</a></h4>
<p>Conform <code>UserToken</code> to <code>ModelTokenAuthenticatable</code>. This will allow for tokens to authenticate your <code>User</code> model.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">import</span> <span class="nc">Vapor</span>
<span class="kd">import</span> <span class="nc">Fluent</span>

<span class="kd">extension</span> <span class="nc">UserToken</span><span class="p">:</span> <span class="n">ModelTokenAuthenticatable</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="kd">let</span> <span class="nv">valueKey</span> <span class="p">=</span> <span class="err">\</span><span class="n">UserToken</span><span class="p">.</span><span class="err">$</span><span class="n">value</span>
    <span class="kd">static</span> <span class="kd">let</span> <span class="nv">userKey</span> <span class="p">=</span> <span class="err">\</span><span class="n">UserToken</span><span class="p">.</span><span class="err">$</span><span class="n">user</span>

    <span class="kd">var</span> <span class="nv">isValid</span><span class="p">:</span> <span class="nb">Bool</span> <span class="p">{</span>
        <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>The first protocol requirement specifies which field stores the token's unique value. This is the value that will be sent in the Bearer authentication header. The second requirement specifies the parent-relation to the <code>User</code> model. This is how Fluent will look up the authenticated user. </p>
<p>The final requirement is an <code>isValid</code> boolean. If this is <code>false</code>, the token will be deleted from the database and the user will not be authenticated. For simplicity, we'll make the tokens eternal by hard-coding this to <code>true</code>.</p>
<p>Now that the token conforms to <code>ModelTokenAuthenticatable</code>, you can create an authenticator for protecting routes.</p>
<p>Create a new endpoint <code>GET /me</code> for getting the currently authenticated user.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">let</span> <span class="nv">tokenProtected</span> <span class="p">=</span> <span class="n">app</span><span class="p">.</span><span class="n">grouped</span><span class="p">(</span><span class="n">UserToken</span><span class="p">.</span><span class="n">authenticator</span><span class="p">())</span>
<span class="n">tokenProtected</span><span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s">&quot;me&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">req</span> <span class="p">-&gt;</span> <span class="n">User</span> <span class="k">in</span>
    <span class="k">try</span> <span class="n">req</span><span class="p">.</span><span class="n">auth</span><span class="p">.</span><span class="n">require</span><span class="p">(</span><span class="n">User</span><span class="p">.</span><span class="kc">self</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>


<p>Similar to <code>User</code>, <code>UserToken</code> now has a static <code>authenticator()</code> method that can generate an authenticator. The authenticator will attempt to find a matching <code>UserToken</code> using the value provided in the Bearer authentication header. If it finds a match, it will fetch the related <code>User</code> and authenticate it. </p>
<p>Test that this route works by sending the following HTTP request where the token is the value you saved from the <code>POST /login</code> request. </p>
<div class="codehilite"><pre><span></span><code><span class="nf">GET</span> <span class="nn">/me</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="o">:</span> <span class="l">Bearer &lt;token&gt;</span>
</code></pre></div>


<p>You should see the authenticated <code>User</code> returned. </p>
<h2 id="session">Session<a class="headerlink" href="#session" title="Permanent link">&para;</a></h2>
<p>Vapor's <a href="../sessions/">Session API</a> can be used to automatically persist user authentication between requests. This works by storing a unique identifier for the user in the request's session data after successful login. On subsequent requests, the user's identifier is fetched from the session and used to authenticate the user before calling your route handler.</p>
<p>Sessions are great for front-end web applications built in Vapor that serve HTML directly to web browsers. For APIs, we recommend using stateless, token-based authentication to persist user data between requests.</p>
<h3 id="session-authenticatable">Session Authenticatable<a class="headerlink" href="#session-authenticatable" title="Permanent link">&para;</a></h3>
<p>To use session-based authentication, you will need a type that conforms to <code>SessionAuthenticatable</code>. For this example, we'll use a simple struct.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">import</span> <span class="nc">Vapor</span>

<span class="kd">struct</span> <span class="nc">User</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">email</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>
</code></pre></div>


<p>To conform to <code>SessionAuthenticatable</code>, you will need to specify a <code>sessionID</code>. This is the value that will be stored in the session data and must uniquely identify the user. </p>
<div class="codehilite"><pre><span></span><code><span class="kd">extension</span> <span class="nc">User</span><span class="p">:</span> <span class="n">SessionAuthenticatable</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">sessionID</span><span class="p">:</span> <span class="nb">String</span> <span class="p">{</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">email</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>For our simple <code>User</code> type, we'll use the email address as the unique session identifier.</p>
<h3 id="session-authenticator">Session Authenticator<a class="headerlink" href="#session-authenticator" title="Permanent link">&para;</a></h3>
<p>Next, we'll need a <code>SessionAuthenticator</code> to handle resolving instances of our User from the persisted session identifier.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">struct</span> <span class="nc">UserSessionAuthenticator</span><span class="p">:</span> <span class="n">SessionAuthenticator</span> <span class="p">{</span>
    <span class="kd">typealias</span> <span class="n">User</span> <span class="p">=</span> <span class="n">App</span><span class="p">.</span><span class="n">User</span>
    <span class="kd">func</span> <span class="nf">authenticate</span><span class="p">(</span><span class="n">sessionID</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="k">for</span> <span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">EventLoopFuture</span><span class="p">&lt;</span><span class="nb">Void</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nv">user</span> <span class="p">=</span> <span class="n">User</span><span class="p">(</span><span class="n">email</span><span class="p">:</span> <span class="n">sessionID</span><span class="p">)</span>
        <span class="n">request</span><span class="p">.</span><span class="n">auth</span><span class="p">.</span><span class="n">login</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">request</span><span class="p">.</span><span class="n">eventLoop</span><span class="p">.</span><span class="n">makeSucceededFuture</span><span class="p">(())</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>Since all the information we need to initialize our example <code>User</code> is contained in the session identifier, we can create and login the user synchronously. In a real-world application, you would likely use the session identifier to perform a database lookup or API request to fetch the rest of the user data before authenticating. </p>
<p>Next, let's create a simple bearer authenticator to perform the initial authentication.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">struct</span> <span class="nc">UserBearerAuthenticator</span><span class="p">:</span> <span class="n">BearerAuthenticator</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">authenticate</span><span class="p">(</span><span class="n">bearer</span><span class="p">:</span> <span class="n">BearerAuthorization</span><span class="p">,</span> <span class="k">for</span> <span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">EventLoopFuture</span><span class="p">&lt;</span><span class="nb">Void</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">bearer</span><span class="p">.</span><span class="n">token</span> <span class="p">==</span> <span class="s">&quot;test&quot;</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nv">user</span> <span class="p">=</span> <span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="s">&quot;hello@vapor.codes&quot;</span><span class="p">)</span>
            <span class="n">request</span><span class="p">.</span><span class="n">auth</span><span class="p">.</span><span class="n">login</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">request</span><span class="p">.</span><span class="n">eventLoop</span><span class="p">.</span><span class="n">makeSucceededFuture</span><span class="p">(())</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>This authenticator will authenticate a user with the email <code>hello@vapor.codes</code> when the bearer token <code>test</code> is sent.</p>
<p>Finally, let's combine all these pieces together in your application.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Create protected route group which requires user auth.</span>
<span class="kd">let</span> <span class="nv">protected</span> <span class="p">=</span> <span class="n">app</span><span class="p">.</span><span class="n">routes</span><span class="p">.</span><span class="n">grouped</span><span class="p">([</span>
    <span class="n">app</span><span class="p">.</span><span class="n">sessions</span><span class="p">.</span><span class="n">middleware</span><span class="p">,</span>
    <span class="n">UserSessionAuthenticator</span><span class="p">(),</span>
    <span class="n">UserBearerAuthenticator</span><span class="p">(),</span>
    <span class="n">User</span><span class="p">.</span><span class="n">guardMiddleware</span><span class="p">(),</span>
<span class="p">])</span>

<span class="c1">// Add GET /me route for reading user&#39;s email.</span>
<span class="n">protected</span><span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s">&quot;me&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">req</span> <span class="p">-&gt;</span> <span class="nb">String</span> <span class="k">in</span>
    <span class="k">try</span> <span class="n">req</span><span class="p">.</span><span class="n">auth</span><span class="p">.</span><span class="n">require</span><span class="p">(</span><span class="n">User</span><span class="p">.</span><span class="kc">self</span><span class="p">).</span><span class="n">email</span>
<span class="p">}</span>
</code></pre></div>


<p><code>SessionsMiddleware</code> is added first to enable session support on the application. More information about configuring sessions can be found in the <a href="../sessions/">Session API</a> section.</p>
<p>Next, the <code>SessionAuthenticator</code> is added. This handles authenticating the user if a session is active. </p>
<p>If the authentication has not been persisted in the session yet, the request will be forwarded to the next authenticator. <code>UserBearerAuthenticator</code> will check the bearer token and authenticate the user if it equals <code>"test"</code>.</p>
<p>Finally, <code>User.guardMiddleware()</code> will ensure that <code>User</code> has been authenticated by one of the previous middleware. If the user has not been authenticated, an error will be thrown. </p>
<p>To test this route, first send the following request:</p>
<div class="codehilite"><pre><span></span><code><span class="nf">GET</span> <span class="nn">/me</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">authorization</span><span class="o">:</span> <span class="l">Bearer test</span>
</code></pre></div>


<p>This will cause <code>UserBearerAuthenticator</code> to authenticate the user. Once authenticated, <code>UserSessionAuthenticator</code> will persist the user's identifier in session storage and generate a cookie. Use the cookie from the response in a second request to the route.</p>
<div class="codehilite"><pre><span></span><code><span class="nf">GET</span> <span class="nn">/me</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">cookie</span><span class="o">:</span> <span class="l">vapor_session=123</span>
</code></pre></div>


<p>This time, <code>UserSessionAuthenticator</code> will authenticate the user and you should again see the user's email returned.</p>
<h3 id="model-session-authenticatable">Model Session Authenticatable<a class="headerlink" href="#model-session-authenticatable" title="Permanent link">&para;</a></h3>
<p>Fluent models can generate <code>SessionAuthenticator</code>s by conforming to <code>ModelSessionAuthenticatable</code>. This will use the model's unique identifier as the session identifier and automatically perform a database lookup to restore the model from the session. </p>
<div class="codehilite"><pre><span></span><code><span class="kd">import</span> <span class="nc">Fluent</span>

<span class="kr">final</span> <span class="kd">class</span> <span class="nc">User</span><span class="p">:</span> <span class="n">Model</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>

<span class="c1">// Allow this model to be persisted in sessions.</span>
<span class="kd">extension</span> <span class="nc">User</span><span class="p">:</span> <span class="n">ModelSessionAuthenticatable</span> <span class="p">{</span> <span class="p">}</span>
</code></pre></div>


<p>You can add <code>ModelSessionAuthenticatable</code> to any existing model as an empty conformance. Once added, a new static method will be available for creating a <code>SessionAuthenticator</code> for that model. </p>
<div class="codehilite"><pre><span></span><code><span class="n">User</span><span class="p">.</span><span class="n">sessionAuthenticator</span><span class="p">()</span>
</code></pre></div>


<p>This will use the application's default database for resolving the user. To specify a database, pass the identifier.</p>
<div class="codehilite"><pre><span></span><code><span class="n">User</span><span class="p">.</span><span class="n">sessionAuthenticator</span><span class="p">(.</span><span class="n">sqlite</span><span class="p">)</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../services/" title="Services" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Services
              </div>
            </div>
          </a>
        
        
          <a href="../crypto/" title="Crypto" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Crypto
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" /></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.36cbf620.min.js"></script>
      <script src="../assets/javascripts/bundle.00c583dd.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.7f7c8775.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>